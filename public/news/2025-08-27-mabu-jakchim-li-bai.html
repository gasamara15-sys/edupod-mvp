<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>[Culture Feature] Mabu-jakchim (磨斧作針): Li Bai’s Lesson in Perseverance | EduPod 뉴스</title>
  <meta name="category" content="History, Culture, Education" />
  <meta name="description" content="‘마부작침(磨斧作針)’—도끼를 갈아 바늘을 만든다는 뜻의 사자성어. 당나라 시인 이백과 노파의 일화를 통해 포기하지 않는 꾸준함의 힘을 전합니다." />
  <link rel="icon" href="/favicon.ico" />
  <link rel="canonical" href="https://www.edupod.kr/news/2025-08-27-mabu-jakchim-li-bai.html" />
  <style>
    :root{
      --border:#e5e7eb;--muted:#6b7280;--accent:#eef2ff;--active:#fff4cc;
      --primary:#111827;--bg:#fafafa;--cta:#4f46e5;--cta-600:#4338ca;--cta-bg:#eef2ff;
      --warn:#ef4444;--warn-600:#dc2626;--warn-bg:#fff5f5;
    }
    html,body{margin:0;padding:0;background:var(--bg)}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans KR',sans-serif;color:var(--primary)}
    header{padding:12px 16px;background:#fff;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:10;display:flex;align-items:center;gap:12px}
    h1{font-size:18px;margin:0;flex:1}
    .nav{display:flex;gap:8px}
    .nav a{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--border);border-radius:999px;padding:6px 10px;background:#fff;text-decoration:none;font-size:13px;color:var(--primary)}
    .nav a:hover{background:#f8fafc}
    main{padding:20px;max-width:980px;margin:0 auto}
    .row{display:flex;gap:16px;flex-wrap:wrap}
    .card{background:#fff;border:1px solid var(--border);border-radius:12px;padding:16px;flex:1 1 360px;box-shadow:0 1px 0 rgba(0,0,0,.02)}
    .meta{font-size:12px;color:var(--muted)}
    .pill{font-size:12px;border:1px solid var(--border);padding:2px 8px;border-radius:999px;background:#fff}
    .headline{font-weight:700}
    .small{font-size:12px;color:var(--muted)}
    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:8px 0}
    select,button,input[type="range"]{border:1px solid var(--border);border-radius:10px;padding:8px 10px;background:#fff;cursor:pointer}
    button.primary{background:var(--cta-bg);border-color:var(--cta);color:var(--cta)}
    button.primary:hover{background:#e6e9ff;border-color:var(--cta-600);color:var(--cta-600)}
    button:disabled{opacity:.5;cursor:not-allowed}
    .level-tabs{display:flex;gap:8px;margin:8px 0 12px;flex-wrap:wrap}
    .level-tabs button{padding:6px 10px}
    .level-tabs button[aria-selected="true"]{background:#111827;color:#fff;border-color:#111827}
    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    @media(min-width:900px){ .grid{grid-template-columns:1.2fr .8fr} }
    .sent{padding:8px 10px;border-radius:8px;margin:6px 0;border:1px dashed transparent}
    .sent:hover{background:#f8fafc}
    .sent.active{background:var(--active);border-color:#fcd34d}
    .en{display:block}
    .ko{display:block;color:#374151;font-size:13px;margin-top:4px}
    .ko.hidden{display:none !important;}
    .quiz{border-top:1px dashed var(--border);margin-top:12px;padding-top:12px}
    .quiz h3{font-size:14px;margin:0 0 6px}
    .footer{font-size:12px;color:var(--muted);margin-top:16px}
    .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;border:1px solid var(--border);border-bottom-width:2px;padding:2px 6px;border-radius:6px;background:#fff}
    .grammar{border-top:1px dashed var(--border);margin-top:12px;padding-top:12px}
    .iconbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin:8px 0}
    .icon-btn{
      width:52px;height:52px;display:grid;place-items:center;
      border:2px solid var(--warn);border-radius:14px;background:#fff;color:var(--warn);
      box-shadow:0 1px 0 rgba(0,0,0,.03)
    }
    .icon-btn:hover{background:var(--warn-bg);border-color:var(--warn-600);color:var(--warn-600)}
    .icon-btn:disabled{opacity:.5}
    .icon-btn svg{width:26px;height:26px;display:block}
    .icon-label{font-size:12px;color:var(--muted);margin-left:2px}
  </style>
</head>
<body>
<header>
  <h1>EduPod 뉴스
    <span class="meta">— 2025-08-27 ·
      <span class="pill">History</span>
      <span class="pill">Culture</span>
      <span class="pill">Education</span>
    </span>
  </h1>
  <nav class="nav" aria-label="주요 이동">
    <a href="/" id="homeLink" title="홈으로">홈으로</a>
    <a href="/news.html/" id="newsListLink" title="뉴스 리스트">뉴스 리스트</a>
  </nav>
</header>

<main>
  <div class="row">
    <div class="card" style="flex:1 1 100%">
      <div class="level-tabs" role="tablist">
        <button role="tab" id="tab-low" aria-selected="false">초등 저학년 (A1–A2)</button>
        <button role="tab" id="tab-high" aria-selected="false">초등 고학년 (A2–B1)</button>
        <button role="tab" id="tab-mid" aria-selected="true">중학생 (A2–B1)</button>
        <button role="tab" id="tab-hs" aria-selected="false">고등/수능 (B2–C1)</button>
      </div>

      <!-- 재생 아이콘 버튼 -->
      <div class="iconbar" aria-label="재생 컨트롤">
        <button id="playAll" class="icon-btn" title="전체 재생" aria-label="전체 재생">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M8 5v14l11-7z"/></svg>
        </button>
        <button id="pauseBtn" class="icon-btn" title="일시정지" aria-label="일시정지">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M6 5h4v14H6zM14 5h4v14h-4z"/></svg>
        </button>
        <button id="resumeBtn" class="icon-btn" title="재개" aria-label="재개">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M8 5v14l11-7z"/></svg>
        </button>
        <button id="stopBtn" class="icon-btn" title="정지" aria-label="정지">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M6 6h12v12H6z"/></svg>
        </button>
        <span class="icon-label">문장 클릭: 해당 문장만 반복</span>
      </div>

      <!-- 보이스/속도 컨트롤 -->
      <div class="controls">
        <label class="small" for="voiceSelect">음성:</label>
        <select id="voiceSelect" aria-label="Voice"></select>
        <span class="small">속도 프리셋:</span>
        <button class="preset" data-rate="0.85">처음 듣기</button>
        <button class="preset" data-rate="1.0">보통</button>
        <button class="preset" data-rate="1.15">빠르게</button>
        <span class="small">세부 속도</span>
        <input id="rate" type="range" min="0.7" max="1.4" step="0.05" value="1.0" />
        <span class="small" id="rateLabel">1.00×</span>
      </div>
    </div>
  </div>

  <div class="grid">
    <div class="card" id="articleCard">
      <div class="meta"><span class="pill" id="topicPill">Culture</span> <span class="pill" id="cefrPill">A2–B1</span></div>
      <div class="headline" id="headline">[Culture Feature] Mabu-jakchim (磨斧作針): Li Bai’s Lesson in Perseverance</div>
      <p class="small" id="dek">“Grind an axe into a needle.” The Tang poet Li Bai meets an old woman by a river—and learns that steady effort defeats doubt and ridicule.</p>

      <!-- 한국어 전체 토글 -->
      <div class="controls" id="koToggleControls">
        <button id="toggleAllKoBtn" class="primary">한국어 가리기</button>
        <span class="small">각 레벨 지문의 한국어 해석을 전체 가립니다.</span>
      </div>

      <div id="sentences"></div>
      <div class="footer">문장을 클릭하면 해당 부분만 <span class="kbd">반복</span> 재생합니다. 전체 재생 중 <span class="kbd">일시정지/재개</span> 가능.</div>

      <div class="quiz">
        <h3>퀴즈</h3>
        <ol id="quizList"></ol>
      </div>

      <div class="grammar" id="grammarBox" style="display:none">
        <h3 id="grammarTitle" style="margin:0 0 6px">문법 포인트</h3>
        <ol id="grammarList"></ol>
      </div>
    </div>

    <div class="card">
      <h2 style="margin:0 0 6px">단어장</h2>
      <ul id="vocab"></ul>
      <p class="small">영어 문장 아래에 한국어 해석이 함께 제공됩니다.</p>
    </div>
  </div>
</main>

<script>
/* =========================
   레벨별 콘텐츠 데이터
   ========================= */
const DATA = {
  // 초등 저학년 (A1–A2) 12줄
  low: {
    topic: "Culture",
    cefr: "A1–A2",
    headline: "Grind an Axe into a Needle",
    dek: "Li Bai learns to never give up.",
    sents: [
      {en:"Li Bai was a young student.", ko:"이백은 젊은 학생이었습니다."},
      {en:"He felt sad because he was not improving.", ko:"공부가 늘지 않아 슬펐습니다."},
      {en:"One day he wanted to quit.", ko:"어느 날 그는 포기하고 싶었습니다."},
      {en:"By a river, he saw an old woman.", ko:"강가에서 한 노파를 보았습니다."},
      {en:"She was grinding an iron axe on a stone.", ko:"노파는 돌에 쇠도끼를 갈고 있었습니다."},
      {en:"Li Bai asked, “Why are you doing that?”", ko:"이백이 물었습니다. “왜 그렇게 하시나요?”"},
      {en:"She said, “I will make a needle.”", ko:"노파는 말했습니다. “바늘을 만들려 한다.”"},
      {en:"Li Bai was shocked. “The axe is too big!”", ko:"이백은 놀랐습니다. “도끼가 너무 큰데요!”"},
      {en:"She said, “If I grind every day, it will become a needle.”", ko:"노파가 말했습니다. “매일 갈면 바늘이 되지.”"},
      {en:"“Do not quit even if people laugh.”", ko:"“남들이 비웃어도 포기하지 말거라.”"},
      {en:"Li Bai understood and went back to study.", ko:"이백은 깨닫고 공부로 돌아갔습니다."},
      {en:"He later became a great poet.", ko:"그는 훗날 위대한 시인이 되었습니다."}
    ],
    vocab: [
      ["grind","갈다/연마하다","Grind the axe on a stone."],
      ["needle","바늘","The woman wanted to make a needle."],
      ["give up","포기하다","Do not give up."]
    ],
    quiz: [
      {q:"What did the old woman want to make?", options:["A needle","A sword","A spoon"], answer:0},
      {tf:true, stmt:"Li Bai decided to keep studying.", answer:true},
      {q:"Where did Li Bai meet the woman?", options:["By a river","In a market","At school"], answer:0}
    ]
  },

  // 초등 고학년 (A2–B1) 15줄
  high: {
    topic: "Education",
    cefr: "A2–B1",
    headline: "Mabu-jakchim: Never Quit",
    dek: "The idiom means “grind an axe until it becomes a needle.”",
    sents: [
      {en:"Li Bai of the Tang dynasty was frustrated with his studies.", ko:"당나라의 이백은 공부에 좌절하고 있었습니다."},
      {en:"He planned to give up and walked away from home.", ko:"그는 포기하려고 집을 떠났습니다."},
      {en:"At a riverbank, an old woman was grinding an iron axe.", ko:"강둑에서 한 노파가 쇠도끼를 갈고 있었습니다."},
      {en:"“I will make a sewing needle,” she said calmly.", ko:"“바느질 바늘을 만들려 한다.” 노파가 담담히 말했습니다."},
      {en:"Li Bai doubted, “How can you make a needle from that?”", ko:"이백은 의아해했습니다. “그걸 어떻게 바늘로요?”"},
      {en:"“Daily effort will do it,” she replied.", ko:"“매일 하면 되지.” 노파가 대답했습니다."},
      {en:"Her words woke him up: effort beats doubt and ridicule.", ko:"그 말은 그를 일깨웠습니다. 노력은 의심과 비웃음을 이깁니다."},
      {en:"He returned to study and later became a great poet.", ko:"그는 공부로 돌아가 훗날 위대한 시인이 되었습니다."},
      {en:"The idiom ‘Mabu-jakchim (磨斧作針)’ was born from this tale.", ko:"이 이야기에서 ‘마부작침(磨斧作針)’이라는 사자성어가 전해집니다."},
      {en:"It teaches perseverance and steady practice.", ko:"이는 끈기와 꾸준한 연습을 가르칩니다."},
      {en:"The axe stands for a big problem.", ko:"도끼는 큰 문제를 뜻합니다."},
      {en:"The needle stands for a fine result.", ko:"바늘은 정교한 결과를 뜻합니다."},
      {en:"Grinding is small daily action.", ko:"‘가는 일’은 작은 일상의 실천입니다."},
      {en:"Small steps, done daily, can change anything.", ko:"작은 걸음도 매일 하면 무엇이든 바꿀 수 있습니다."},
      {en:"This is why students say, “Mabu-jakchim!”", ko:"그래서 학생들은 “마부작침!”이라고 말합니다."}
    ],
    vocab: [
      ["perseverance","끈기","Perseverance wins in the end."],
      ["ridicule","비웃음","Ignore ridicule and keep going."],
      ["whetstone","숫돌/맷돌","A whetstone is used for grinding."]
    ],
    quiz: [
      {q:"What does the axe symbolize?", options:["A big problem","A small toy","A prize"], answer:0},
      {tf:true, stmt:"Mabu-jakchim teaches daily practice.", answer:true},
      {q:"What changed Li Bai’s mind?", options:["The woman’s words","A gold coin","A loud storm"], answer:0}
    ]
  },

  // 중학생 (A2–B1) 20줄+
  mid: {
    topic: "Culture",
    cefr: "A2–B1",
    headline: "From Doubt to Discipline: The Origin of Mabu-jakchim (磨斧作針)",
    dek: "Li Bai’s riverbank encounter became a proverb of perseverance across East Asia.",
    sents: [
      {en:"As a young scholar, Li Bai felt stuck and ashamed of slow progress.", ko:"젊은 학자였던 이백은 진척이 없어 답답했고 부끄러웠습니다."},
      {en:"He decided to abandon study and headed out, heavy with doubt.", ko:"그는 공부를 포기하려 결심하고 의심을 안은 채 길을 나섰습니다."},
      {en:"At a riverbank, an old woman calmly ground an iron axe on a whetstone.", ko:"강가에서 한 노파가 숫돌에 쇠도끼를 차분히 갈고 있었습니다."},
      {en:"Curious, Li Bai asked what she was making.", ko:"호기심이 생긴 이백은 무엇을 만드는지 물었습니다."},
      {en:"“A needle,” she answered, without looking up.", ko:"노파는 고개도 들지 않고 “바늘”이라고 답했습니다."},
      {en:"He protested: the tool was too large for such a task.", ko:"그는 도끼가 너무 크다고 반박했습니다."},
      {en:"She replied, “If I grind it daily, it will become a needle.”", ko:"노파는 “매일 갈면 바늘이 되지”라고 말했습니다."},
      {en:"Her logic was simple: tiny efforts, repeated, reshape the world.", ko:"그 논리는 단순했습니다. 작은 노력이 반복되면 세상을 바꿉니다."},
      {en:"Ridicule from others should not stop steady work.", ko:"남들의 비웃음이 꾸준함을 막아선 안 됩니다."},
      {en:"The scene struck Li Bai like a bell.", ko:"그 장면은 종소리처럼 이백의 마음을 울렸습니다."},
      {en:"He returned to study with renewed discipline.", ko:"그는 새로워진 태도로 공부로 돌아갔습니다."},
      {en:"In time, he became one of China’s greatest poets.", ko:"시간이 흐르자 그는 중국의 위대한 시인이 되었습니다."},
      {en:"The idiom ‘Mabu-jakchim (磨斧作針)’ literally means “grind an axe to make a needle.”", ko:"‘마부작침(磨斧作針)’은 문자 그대로 ‘도끼를 갈아 바늘을 만든다’는 뜻입니다."},
      {en:"Axe means a big, rough beginning; needle means a precise, finished result.", ko:"도끼는 거대한 출발, 바늘은 정교한 완성을 뜻합니다."},
      {en:"Grinding stands for daily practice that shapes skill and character.", ko:"‘가는 일’은 실력과 품성을 다듬는 일상 훈련을 상징합니다."},
      {en:"The lesson is clear: patient discipline outlasts quick talent.", ko:"교훈은 분명합니다. 인내하는 훈련은 재능보다 오래갑니다."},
      {en:"For students, it suggests short, regular study beats cramming.", ko:"학생에게는 짧고 규칙적인 공부가 벼락치기를 이긴다는 뜻입니다."},
      {en:"For creators, it means drafts and revisions forge mastery.", ko:"창작자에게는 초고와 수정이 장인을 만든다는 의미입니다."},
      {en:"For everyone, it says: keep going, even when mocked.", ko:"모두에게는 비웃음을 들어도 계속 가라는 메시지입니다."}
    ],
    vocab: [
      ["discipline","훈련/자기절제","Discipline turns effort into results."],
      ["cram","벼락치기하다","Cramming is less effective than steady study."],
      ["forge","단련해 만들다","Drafts forge mastery over time."]
    ],
    quiz: [
      {q:"What does ‘grinding’ represent in the story?", options:["Daily practice","Anger","Magic"], answer:0},
      {tf:true, stmt:"The needle symbolizes a precise, finished result.", answer:true},
      {q:"Which habit aligns with Mabu-jakchim?", options:["Short, regular practice","Waiting for inspiration only","Quitting when mocked"], answer:0}
    ],
    grammar: [
      {
        en:"Even if others ridicule you, keep practicing every day.",
        ko:"남들이 비웃더라도 매일 연습을 이어가라.",
        point:"양보절 even if",
        q:"(___) others ridicule you, keep practicing every day.",
        options:["Even if","Because","Unless"],
        answer:0
      },
      {
        en:"Small efforts, repeated over time, can make a great change.",
        ko:"작은 노력도 시간이 지나 반복되면 큰 변화를 만든다.",
        point:"분사구문(과거분사) / 수동 의미",
        q:"Small efforts, (___) over time, can make a great change.",
        options:["repeated","repeating","to repeat"],
        answer:0
      }
    ]
  },

  // 고등/수능 (B2–C1) 26줄
  hs: {
    topic: "History",
    cefr: "B2–C1",
    headline: "Mabu-jakchim (磨斧作針): From Metaphor to Method",
    dek: "A cultural idiom becomes a practical framework for mastery.",
    sents: [
      {en:"The idiom ‘Mabu-jakchim’ literally means “grind an axe to make a needle.”", ko:"‘마부작침’은 문자 그대로 ‘도끼를 갈아 바늘을 만든다’는 뜻입니다."},
      {en:"Its popular origin tale features Li Bai (Li Bo), the Tang dynasty poet.", ko:"널리 알려진 유래는 당나라 시인 이백(이보)의 일화입니다."},
      {en:"Disheartened by slow progress, he resolved to abandon scholarship.", ko:"더딘 진전에 낙담한 그는 학문을 접으려 했습니다."},
      {en:"At a riverside, an old woman ground an iron axe against a whetstone.", ko:"강가에서 한 노파가 숫돌에 쇠도끼를 갈고 있었습니다."},
      {en:"When he asked why, she answered: “To make a needle.”", ko:"그가 이유를 묻자 노파는 “바늘을 만들려 한다”고 답했습니다."},
      {en:"He objected to the absurd ratio of tool to outcome.", ko:"그는 도구와 결과의 불균형을 지적했습니다."},
      {en:"Her reply was method, not miracle: daily abrasion reshapes metal.", ko:"노파의 대답은 기적이 아닌 방법론이었습니다. 일상적 연마가 금속을 바꿉니다."},
      {en:"Metaphorically, the axe is a rough beginning; the needle, a refined skill.", ko:"비유적으로 도끼는 거친 시작, 바늘은 정제된 기량입니다."},
      {en:"Grinding encodes the algorithm of mastery: repetition × time × feedback.", ko:"연마는 숙련의 알고리즘—반복×시간×피드백—을 담습니다."},
      {en:"Ridicule is noise; perseverance is the signal.", ko:"비웃음은 잡음이고, 끈기는 신호입니다."},
      {en:"Li Bai returned to study and later entered the canon of Chinese poetry.", ko:"이백은 공부로 돌아가 훗날 중국 시 문학의 정전에 올랐습니다."},
      {en:"As pedagogy, the idiom rejects “talent-only” myths.", ko:"교육적으로 이 성어는 ‘재능만능’ 신화를 거부합니다."},
      {en:"It favors consistent inputs over sporadic cramming.", ko:"이는 산발적 벼락치기보다 꾸준한 투입을 선호합니다."},
      {en:"It reframes failure as incomplete iteration, not identity.", ko:"실패를 정체성이 아닌 미완의 반복으로 재구성합니다."},
      {en:"Applied to language learning: short daily drills beat long monthly sessions.", ko:"언어 학습에 적용하면, 매일의 짧은 훈련이 한 달에 한 번 긴 공부보다 낫습니다."},
      {en:"Applied to research: prototypes, peer feedback, and revision cycles.", ko:"연구에는 시제품·동료 피드백·수정 주기가 핵심입니다."},
      {en:"Applied to well-being: habits compound while motivation fluctuates.", ko:"웰빙에는 습관이 복리로 쌓이고 동기는 변동합니다."},
      {en:"Philologically: 磨(grind) 斧(axe) 作(make) 針(needle) compresses process into four glyphs.", ko:"어문학적으로 磨(갈다) 斧(도끼) 作(만들다) 針(바늘) 네 글자는 과정을 압축합니다."},
      {en:"Rhetorically: paradox (axe→needle) shocks, then instructs.", ko:"수사학적으로 ‘도끼→바늘’의 역설은 놀라게 하고 가르칩니다."},
      {en:"Ethically: dignity lies in steadfast labor despite mockery.", ko:"윤리적으로 조롱 속에서도 흔들리지 않는 노력이 품위를 만듭니다."},
      {en:"Pragmatically: define a micro-task, repeat daily, and track feedback.", ko:"실천적으로 미시 과업을 정의하고 매일 반복하며 피드백을 기록하십시오."},
      {en:"Thus the idiom travels from parable to practice.", ko:"이렇게 성어는 비유에서 실천으로 이동합니다."},
      {en:"And its counsel is unfashionably simple: keep grinding.", ko:"결국 권고는 투박할 만큼 단순합니다. 계속 갈아라."}
    ],
    vocab: [
      ["abrasion","마찰/연마","Daily abrasion reshapes metal—and skill."],
      ["iteration","반복/반복 과정","Treat failure as incomplete iteration."],
      ["canon","정전(正典)","Li Bai entered the literary canon."]
    ],
    quiz: [
      {q:"In the idiom, what does “grinding” most closely represent?", options:["Consistent practice","Buying new tools","Waiting for luck"], answer:0},
      {tf:true, stmt:"The ‘needle’ symbolizes refined, precise skill.", answer:true},
      {q:"Which plan best follows Mabu-jakchim?", options:["Daily micro-tasks with feedback","Irregular all-night study","Quitting when progress is slow"], answer:0}
    ],
    grammar: [
      {
        en:"No matter how large the task appears, steady effort can reduce it.",
        ko:"과제가 아무리 커 보여도 꾸준한 노력이면 줄일 수 있다.",
        point:"양보 강조: no matter how + 형용사",
        q:"(___) matter (___) large the task appears, steady effort can reduce it.",
        options:["No / how","It / how","No / very"],
        answer:0
      },
      {
        en:"Had he not met the old woman, he might have given up.",
        ko:"그가 노파를 만나지 않았다면 포기했을지도 모른다.",
        point:"가정법 과거완료(도치)",
        q:"(___) he not met the old woman, he (___) have given up.",
        options:["Had / might","If / must","Were / will"],
        answer:0
      },
      {
        en:"What began as doubt ended as discipline.",
        ko:"의심으로 시작한 것이 훈련으로 마무리되었다.",
        point:"평행 구조 / 대조",
        q:"What began as (___) ended as (___).",
        options:["doubt / discipline","talent / luck","noise / silence"],
        answer:0
      }
    ]
  }
};

/* =========================
   공통 DOM 참조
   ========================= */
const levelTabs = {
  low: document.getElementById('tab-low'),
  high: document.getElementById('tab-high'),
  mid: document.getElementById('tab-mid'),
  hs: document.getElementById('tab-hs')
};
const voiceSelect = document.getElementById('voiceSelect');
const rateRange = document.getElementById('rate');
const rateLabel = document.getElementById('rateLabel');
const sentencesEl = document.getElementById('sentences');
const quizList = document.getElementById('quizList');
const vocabEl = document.getElementById('vocab');
const topicPill = document.getElementById('topicPill');
const cefrPill = document.getElementById('cefrPill');
const headlineEl = document.getElementById('headline');
const dekEl = document.getElementById('dek');
const grammarBox = document.getElementById('grammarBox');
const grammarList = document.getElementById('grammarList');
const grammarTitle = document.getElementById('grammarTitle');

const playAllBtn = document.getElementById('playAll');
const pauseBtn = document.getElementById('pauseBtn');
const resumeBtn = document.getElementById('resumeBtn');
const stopBtn = document.getElementById('stopBtn');

const toggleAllKoBtn = document.getElementById('toggleAllKoBtn');
let hideAllKo = false;

let LEVEL = 'mid';
let VOICES = [];
let CURRENT_INDEX = -1;
let PLAYING_ALL = false;

/* =========================
   음성 목록 로딩
   ========================= */
function loadVoices(){
  VOICES = speechSynthesis.getVoices().filter(v => v.lang && v.lang.startsWith('en'));
  voiceSelect.innerHTML = '';
  VOICES.forEach((v,i)=>{
    const opt=document.createElement('option');
    opt.value=i; opt.textContent=`${v.name} (${v.lang})`+(v.default?' • default':'');
    voiceSelect.appendChild(opt);
  });
  const preferred = VOICES.findIndex(v=>/en-US/i.test(v.lang)&&/Female|Jenny|Aria|Salli|female/i.test(v.name));
  voiceSelect.value = String(preferred>=0?preferred:0);
}
speechSynthesis.onvoiceschanged = loadVoices;
if (speechSynthesis.getVoices().length) loadVoices();

/* =========================
   속도 프리셋/표시
   ========================= */
document.querySelectorAll('.preset').forEach(btn=>{
  btn.addEventListener('click',()=>{
    const r=parseFloat(btn.dataset.rate);
    rateRange.value=r; rateLabel.textContent=r.toFixed(2)+'×';
  });
});
rateRange.addEventListener('input',()=> rateLabel.textContent=parseFloat(rateRange.value).toFixed(2)+'×');

/* =========================
   레벨 전환
   ========================= */
levelTabs.low.addEventListener('click',()=>switchLevel('low'));
levelTabs.high.addEventListener('click',()=>switchLevel('high'));
levelTabs.mid.addEventListener('click',()=>switchLevel('mid'));
levelTabs.hs.addEventListener('click',()=>switchLevel('hs'));

/* =========================
   재생 컨트롤
   ========================= */
playAllBtn.addEventListener('click',()=>startPlayAll());
pauseBtn.addEventListener('click',()=>speechSynthesis.pause());
resumeBtn.addEventListener('click',()=>speechSynthesis.resume());
stopBtn.addEventListener('click',stopAll);

/* =========================
   한국어 전체 토글
   ========================= */
toggleAllKoBtn.addEventListener('click', () => {
  hideAllKo = !hideAllKo;
  applyAllKoVisibility();
});
function applyAllKoVisibility(){
  const kos = document.querySelectorAll('#sentences .ko');
  kos.forEach(el => { hideAllKo ? el.classList.add('hidden') : el.classList.remove('hidden'); });
  toggleAllKoBtn.textContent = hideAllKo ? '한국어 보이기' : '한국어 가리기';
}

/* =========================
   레벨 렌더링
   ========================= */
function switchLevel(lv){
  LEVEL=lv;
  for(const k of Object.keys(levelTabs)){
    levelTabs[k].setAttribute('aria-selected',k===lv?'true':'false');
  }
  const d=DATA[lv];
  topicPill.textContent=d.topic;
  cefrPill.textContent=d.cefr;
  headlineEl.textContent=d.headline;
  dekEl.textContent=d.dek;

  // 문장 렌더 (영/한)
  sentencesEl.innerHTML='';
  d.sents.forEach((o,i)=>{
    const div=document.createElement('div');
    div.className='sent'; div.dataset.idx=i;
    div.innerHTML = `<span class="en">${o.en}</span><span class="ko">${o.ko}</span>`;
    div.addEventListener('click',()=>playSentence(i,true));
    sentencesEl.appendChild(div);
  });

  // 단어장
  vocabEl.innerHTML='';
  (d.vocab||[]).forEach(([en,ko,ex])=>{
    const li=document.createElement('li');
    li.innerHTML=`<b>${en}</b> — ${ko}<br><span class="small">${ex}</span>`;
    vocabEl.appendChild(li);
  });

  // 퀴즈
  quizList.innerHTML='';
  (d.quiz||[]).forEach((q,i)=>{
    const li=document.createElement('li');
    if(q.tf){
      li.innerHTML=`<div>${q.stmt}</div>
      <div class="controls">
        <button data-q="${i}" data-a="true">True</button>
        <button data-q="${i}" data-a="false">False</button>
        <span class="small" id="qfb-${i}"></span>
      </div>`;
    }else{
      const opts=q.options.map((o,oi)=>`<button data-q="${i}" data-a="${oi}">${o}</button>`).join(' ');
      li.innerHTML=`<div>${q.q}</div><div class="controls">${opts}<span class="small" id="qfb-${i}"></span></div>`;
    }
    quizList.appendChild(li);
  });
  quizList.querySelectorAll('button').forEach(b=>{
    b.addEventListener('click',(e)=>{
      const qidx=parseInt(e.target.dataset.q,10);
      const ansRaw=e.target.dataset.a;
      const dataQ=DATA[LEVEL].quiz[qidx];
      const correct = dataQ.tf ? (String(dataQ.answer)===ansRaw) : (dataQ.answer===parseInt(ansRaw,10));
      document.getElementById('qfb-'+qidx).textContent = correct?'정답!':'다시 생각해봐요';
    });
  });

  // 문법(있을 때만 표시)
  if(d.grammar){
    grammarBox.style.display='';
    const titleMap = {
      low:"문법 포인트 (초등 저학년)",
      high:"문법 포인트 (초등 고학년)",
      mid:"문법 포인트 (중학생)",
      hs:"문법 포인트 (고등/수능)"
    };
    grammarTitle.textContent = titleMap[LEVEL] || "문법 포인트";
    grammarList.innerHTML='';
    d.grammar.forEach((g,i)=>{
      const li=document.createElement('li');
      const opts=g.options.map((o,oi)=>`<button data-g="${i}" data-a="${oi}">${o}</button>`).join(' ');
      li.innerHTML = `<div><b>${g.en}</b><br><span class="small">${g.ko}</span><br><span class="small">포인트: ${g.point}</span></div>
                      <div class="controls"><span class="small">${g.q}</span></div>
                      <div class="controls">${opts}<span class="small" id="gfb-${i}"></span></div>`;
      grammarList.appendChild(li);
    });
    grammarList.querySelectorAll('button').forEach(btn=>{
      btn.addEventListener('click',(e)=>{
        const gidx=parseInt(e.target.dataset.g,10);
        const ans=parseInt(e.target.dataset.a,10);
        const cor=DATA[LEVEL].grammar[gidx].answer;
        document.getElementById('gfb-'+gidx).textContent=(ans===cor)?'정답!':'다시 시도해보세요';
      });
    });
  }else{
    grammarBox.style.display='none';
    grammarList.innerHTML='';
  }

  applyAllKoVisibility();
  stopAll();
}

// 초기 렌더: 중학생
switchLevel('mid');

/* =========================
   음성 합성 재생
   ========================= */
function getSelectedVoice(){
  const idx=parseInt(voiceSelect.value||'0',10);
  return VOICES[idx]||null;
}
function markActive(i){
  sentencesEl.querySelectorAll('.sent').forEach((el,j)=>{ el.classList.toggle('active',j===i); });
}
function clearMarks(){ sentencesEl.querySelectorAll('.sent').forEach(el=>el.classList.remove('active')); }
function stopAll(){ PLAYING_ALL=false; CURRENT_INDEX=-1; speechSynthesis.cancel(); clearMarks(); }

function playSentence(i,repeat=false){
  stopAll();
  const d=DATA[LEVEL]; const text=d.sents[i].en;
  CURRENT_INDEX=i; markActive(i);
  const u=new SpeechSynthesisUtterance(text);
  const v=getSelectedVoice(); if(v) u.voice=v;
  u.lang=(v&&v.lang)||'en-US'; u.rate=parseFloat(rateRange.value); u.pitch=1.0;
  u.onend=()=>{ if(repeat){ setTimeout(()=>playSentence(i,true),250);} else { CURRENT_INDEX=-1; clearMarks(); } };
  speechSynthesis.speak(u);
}

function startPlayAll(){
  stopAll(); PLAYING_ALL=true;
  const d=DATA[LEVEL]; let i=0;
  const next=()=>{
    if(!PLAYING_ALL) return;
    if(i>=d.sents.length){ stopAll(); return; }
    CURRENT_INDEX=i; markActive(i);
    const u=new SpeechSynthesisUtterance(d.sents[i].en);
    const v=getSelectedVoice(); if(v) u.voice=v;
    u.lang=(v&&v.lang)||'en-US'; u.rate=parseFloat(rateRange.value); u.pitch=1.0;
    u.onend=()=>{ setTimeout(()=>{ i++; next(); }, 250); };
    speechSynthesis.speak(u);
  };
  next();
}

/* =========================
   키보드 단축키
   ========================= */
window.addEventListener('keydown',(e)=>{
  if(e.code==='Space'){
    e.preventDefault();
    if(speechSynthesis.speaking && !speechSynthesis.paused) speechSynthesis.pause();
    else speechSynthesis.resume();
  }
  if(e.code==='Digit1'){ switchLevel('low'); }
  if(e.code==='Digit2'){ switchLevel('high'); }
  if(e.code==='Digit3'){ switchLevel('mid'); }
  if(e.code==='Digit4'){ switchLevel('hs'); }
});
</script>
</body>
</html>
